<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>REACTOR ‚Äî –î–µ–º–æ</title>
  <!-- üîµ Google Identity Services -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: #0d0d1a;
      color: white;
      font-family: 'Segoe UI', sans-serif;
      text-align: center;
      overflow: hidden;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      touch-action: manipulation;
    }

    .demo-banner {
      background: #ff3b30;
      color: white;
      padding: 8px;
      font-weight: bold;
      font-size: 14px;
      letter-spacing: 0.5px;
      text-shadow: 0 1px 2px rgba(0,0,0,0.3);
      position: relative;
      z-index: 30;
      text-align: center;
    }

    #top-ui {
      position: absolute;
      top: 42px;
      right: 12px;
      display: flex;
      gap: 12px;
      z-index: 20;
    }

    .icon-btn {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: rgba(30, 30, 46, 0.7);
      border: 1px solid #4deeea;
      color: white;
      font-size: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      backdrop-filter: blur(4px);
      transition: all 0.2s ease;
      padding: 0;
    }

    .icon-btn:hover {
      background: rgba(77, 238, 234, 0.2);
      transform: scale(1.1);
      border-color: #4deeea;
    }

    .icon-btn:focus {
      outline: none;
    }

    .screen {
      display: none;
      width: 100vw;
      height: 100vh;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 20px;
      box-sizing: border-box;
      position: absolute;
      top: 0;
      left: 0;
    }
    .active { display: flex !important; }

    h1 {
      font-size: 32px;
      color: #4deeea;
      margin-bottom: 20px;
      z-index: 5;
    }

    .subtitle {
      font-size: 18px;
      color: #aaa;
      margin-bottom: 30px;
      max-width: 500px;
      line-height: 1.5;
    }

    .dice {
      width: 80px;
      height: 80px;
      background: #1e1e2e;
      border: 3px solid #555;
      border-radius: 16px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 40px;
      font-weight: bold;
      margin: 30px 0;
      z-index: 5;
      position: relative;
    }

    .dice.animate {
      animation: toss 2.2s cubic-bezier(0.3, 0.8, 0.5, 1) forwards;
    }

    @keyframes toss {
      0% { transform: translateY(0) rotate(0deg); opacity: 1; }
      30% { transform: translateY(-120px) rotate(180deg); }
      60% { transform: translateY(-60px) rotate(360deg); }
      80% { transform: translateY(-20px) rotate(540deg); }
      100% { transform: translateY(0) rotate(720deg); opacity: 1; }
    }

    button {
      padding: 10px 24px;
      background: #4deeea;
      border: none;
      border-radius: 8px;
      color: #000;
      font-weight: bold;
      font-size: 16px;
      cursor: pointer;
      margin-top: 20px;
      z-index: 5;
      position: relative;
    }

    #board {
      display: grid;
      grid-template-columns: repeat(7, min(52px, calc((100vw - 40px) / 7)));
      grid-gap: 3px;
      margin: 12px auto;
      max-width: calc(7 * min(52px, (100vw - 40px) / 7) + 24px);
    }
    .cell {
      width: min(52px, calc((100vw - 40px) / 7 - 3px));
      height: min(52px, calc((100vw - 40px) / 7 - 3px));
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: min(22px, calc((100vw - 40px) / 7 * 0.42));
      cursor: pointer;
      transition: transform 0.15s, background 0.2s;
      background: #1a1a2a;
      touch-action: manipulation;
    }
    .cell:hover { transform: scale(1.03); }
    .player1 { background: #1e3a8a; color: #bfdbfe; }
    .player2 { background: #991b1b; color: #fecaca; }
    .reactor::after { content: "‚óè"; font-size: min(18px, calc((100vw - 40px) / 7 * 0.35)); }

    /* üî• –£—Å–∏–ª–µ–Ω–Ω–∞—è —Ü–µ–ø–Ω–∞—è —Ä–µ–∞–∫—Ü–∏—è */
    .cell.chain {
      animation: chainReaction 0.8s cubic-bezier(0.1, 0.9, 0.4, 1) forwards;
    }
    @keyframes chainReaction {
      0% { 
        transform: scale(1); 
        box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.8);
        z-index: 10;
      }
      40% { 
        transform: scale(1.3); 
        box-shadow: 0 0 0 12px rgba(255, 215, 0, 1), 0 0 20px rgba(255, 165, 0, 0.8);
        z-index: 10;
      }
      100% { 
        transform: scale(1); 
        box-shadow: 0 0 0 0 rgba(255, 215, 0, 0);
        z-index: auto;
      }
    }

    #status {
      margin: 14px 0;
      font-size: 18px;
      min-height: 24px;
      font-weight: bold;
    }

    #score {
      display: flex;
      justify-content: center;
      gap: 30px;
      margin: 8px 0;
      font-size: 15px;
    }
    .score-box {
      padding: 6px 16px;
      border-radius: 10px;
    }
    .you { border: 2px solid #4deeea; }
    .bot { border: 2px solid #ff6b6b; }

    #footer {
      margin: 20px auto;
      font-size: 12px;
      color: #666;
      max-width: 400px;
      line-height: 1.5;
    }

    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(4px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 100;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s, visibility 0.3s;
    }

    .modal-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .modal {
      background: #141424;
      border: 2px solid #4deeea;
      border-radius: 16px;
      padding: 24px;
      width: 90%;
      max-width: 400px;
      text-align: center;
      box-shadow: 0 0 20px rgba(77, 238, 234, 0.3);
      position: relative;
      transform: scale(0.9);
      transition: transform 0.3s ease;
    }

    .notification-modal {
      max-width: 320px;
    }
    .notification-modal h2 {
      font-size: 18px;
      margin: 0 0 12px;
      color: #4deeea;
    }
    .notification-modal p {
      font-size: 15px;
      margin: 0;
      color: #ccc;
    }

    .modal-overlay.active .modal {
      transform: scale(1);
    }

    /* Changelog & Info Accordions */
    .patch-entry,
    .info-section {
      margin: 14px 0;
      border: 1px solid #333;
      border-radius: 10px;
      overflow: hidden;
      background: rgba(30, 30, 46, 0.3);
    }

    .patch-header,
    .info-header {
      padding: 12px 16px;
      background: rgba(77, 238, 234, 0.1);
      color: #4deeea;
      font-weight: bold;
      font-size: 16px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: background 0.2s;
    }

    .patch-header:hover,
    .info-header:hover {
      background: rgba(77, 238, 234, 0.2);
    }

    .patch-arrow,
    .info-arrow {
      width: 16px;
      height: 16px;
      transition: transform 0.3s ease;
      fill: #4deeea;
    }

    .patch-content,
    .info-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.4s ease, padding 0.4s ease;
      background: rgba(20, 20, 36, 0.6);
      color: #ccc;
      padding: 0 16px;
    }

    .patch-content.open,
    .info-content.open {
      max-height: 400px;
      padding: 16px;
    }

    .patch-content ul,
    .info-content ul {
      text-align: left;
      padding-left: 20px;
      margin: 0;
      line-height: 1.6;
    }

    .patch-content li,
    .info-content li {
      margin-bottom: 6px;
    }

    .info-content {
      text-align: left;
      line-height: 1.5;
    }

    .info-content p {
      margin: 8px 0;
    }

    .close-modal {
      position: absolute;
      top: 12px;
      right: 12px;
      background: none;
      border: none;
      width: 24px;
      height: 24px;
      cursor: pointer;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: background 0.2s;
    }

    .close-modal:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .close-modal svg {
      width: 16px;
      height: 16px;
      fill: #aaa;
      transition: fill 0.2s;
    }

    .close-modal:hover svg {
      fill: white;
    }

    /* üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
    .stats-box {
      margin-top: 16px;
      padding: 12px;
      background: rgba(30, 30, 46, 0.5);
      border-radius: 8px;
      text-align: left;
    }
    .stats-row {
      display: flex;
      justify-content: space-between;
      margin: 6px 0;
    }
    .stats-label { color: #aaa; }
    .stats-value { font-weight: bold; }
    .winrate-good { color: #4deeea; }
    .winrate-bad { color: #ff6b6b; }

    /* üë§ –ê–≤–∞—Ç–∞—Ä */
    #user-avatar {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: #333;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      font-weight: bold;
      color: white;
    }

    /* üîô –ö–Ω–æ–ø–∫–∞ –≤—ã—Ö–æ–¥–∞ */
    #logout-btn {
      background: #555;
      margin-top: 8px;
    }

    /* ‚úÖ –ù–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ */
    .auth-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 16px;
      max-width: 340px;
      margin: 30px auto 0;
    }

    .auth-btn {
      opacity: 0;
      transform: translateY(20px);
      animation: fadeInUp 0.6s forwards;
    }
    .auth-btn:nth-child(1) { animation-delay: 0.1s; }
    .auth-btn:nth-child(2) { animation-delay: 0.2s; }

    @keyframes fadeInUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .google-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 14px;
      width: 100%;
      padding: 16px;
      background: #4285F4;
      color: white;
      font-weight: bold;
      font-size: 16px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.25s ease;
      box-shadow: 0 4px 10px rgba(66, 133, 244, 0.35);
      position: relative;
      overflow: hidden;
    }
    .google-btn::before {
      content: '';
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: linear-gradient(135deg, rgba(255,255,255,0.15), transparent);
      opacity: 0;
      transition: opacity 0.3s;
    }
    .google-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 14px rgba(66, 133, 244, 0.5);
      background: #357ae8;
    }
    .google-btn:hover::before {
      opacity: 1;
    }
    .google-btn svg { flex-shrink: 0; }

    .guest-btn {
      width: 100%;
      padding: 14px;
      background: #2d2d3d;
      color: #ccc;
      font-size: 15px;
      border: 1px solid #404050;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.2s;
    }
    .guest-btn:hover {
      background: #353545;
      color: #e0e0ff;
      border-color: #505060;
      transform: translateY(-1px);
    }

    /* üåÄ –ò–∫–æ–Ω–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ */
    .spinner {
      width: 18px;
      height: 18px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-top: 2px solid white;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      display: none;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    .google-btn.loading .spinner {
      display: block;
    }
    .google-btn.loading span {
      opacity: 0;
    }
  </style>

  <!-- üîä –ó–≤—É–∫–∏ (base64 –∑–∞–≥–ª—É—à–∫–∏) -->
  <audio id="sound-click" preload="auto">
    <source src="audio/mpeg;base64,SUQzBAAAAAABEVRYWFgAAAAtAAADY29tbWVudABCaWdTb3VuZEJhbmsuY29tIC8gTGlua3MuY29tU0VDAAAAAAABIjREUU1BQzRnQlNlZ2JlaF9nTl9nZ2JfZ2xnZ2lfQWxhbm5hX2xhZ19sYWdfQWxhbm5hX1NvdW5kX0JhbmtfY29tX0xpbmtzX2NvbQAAAA8AAANMYXZjNTcuODMuMTAw" type="audio/mpeg">
  </audio>
  <audio id="sound-toss" preload="auto">
    <source src="audio/mpeg;base64,SUQzBAAAAAABEVRYWFgAAAAtAAADY29tbWVudABCaWdTb3VuZEJhbmsuY29tIC8gTGlua3MuY29tU0VDAAsMDAoKCQkICAYGBQUFBAQDAwEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQIA//8AAAAEAAABAAAFqAD4AABpAAAAAAAWAAAA" type="audio/mpeg">
  </audio>
  <audio id="sound-result" preload="auto">
    <source src="audio/mpeg;base64,SUQzBAAAAAABEVRYWFgAAAAtAAADY29tbWVudABCaWdTb3VuZEJhbmsuY29tIC8gTGlua3MuY29tU0VDAAACAwQFBgcICQoL" type="audio/mpeg">
  </audio>
</head>
<body>
  <div class="demo-banner">
    –î–ï–ú–û-–í–ï–†–°–ò–Ø
  </div>

  <div id="top-ui">
    <button id="profile-btn" class="icon-btn" title="Profile">üë§</button>
    <button id="settings-btn" class="icon-btn" title="Settings">‚öôÔ∏è</button>
    <button id="changelog-btn" class="icon-btn" title="Changelog">üìñ</button>
    <button id="support-btn" class="icon-btn" title="Support">üí¨</button>
    <button id="info-btn" class="icon-btn" title="Info">‚ùì</button>
  </div>

  <div id="main-menu" class="screen active">
    <h1>REACTOR</h1>
    <p class="subtitle">
      –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫—É—é –∏–≥—Ä—É, –≥–¥–µ –∫–∞–∂–¥—ã–π —Ö–æ–¥ —Ä–µ—à–∞–µ—Ç –∏—Å—Ö–æ–¥ –±–∏—Ç–≤—ã –∑–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å!<br>
      –ü–æ—Å—Ç—Ä–æ–π—Ç–µ —Ä–µ–∞–∫—Ç–æ—Ä—ã, –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–π—Ç–µ –∫–ª–µ—Ç–∫–∏ –∏ –æ–±—ã–≥—Ä–∞–π—Ç–µ –±–æ—Ç–∞ –∑–∞ 14 —Ö–æ–¥–æ–≤.
    </p>
    <div class="auth-container">
      <button id="google-btn" class="google-btn auth-btn">
        <svg width="20" height="20" viewBox="0 0 24 24"><path fill="#fff" d="M12.24 10.285V14.4h6.806c-.275 1.765-2.056 5.174-6.806 5.174-4.095 0-7.439-3.389-7.439-7.574s3.345-7.574 7.439-7.574c2.33 0 3.891.989 4.785 1.849l3.234-3.138C18.189 1.186 15.479 0 12.24 0c-6.635 0-12 5.365-12 12s5.365 12 12 12c6.926 0 11.52-4.869 11.52-11.726 0-.788-.085-1.39-.189-1.989H12.24z"/></svg>
        <span>–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å Google</span>
        <div class="spinner"></div>
      </button>
      <button onclick="loginAsGuest()" class="guest-btn auth-btn">
        –ò–≥—Ä–∞—Ç—å –∫–∞–∫ –≥–æ—Å—Ç—å
      </button>
    </div>
    <div id="user-info" style="display:none;margin-top:30px">
      <div id="user-avatar"></div>
      <div id="user-name" style="margin-top:12px;font-weight:bold;font-size:20px"></div>
      <button onclick="goToStartScreen()" style="margin-top:16px;padding:12px 28px">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
      <button id="logout-btn" onclick="logout()" style="margin-top:10px;padding:10px 24px">–í—ã–π—Ç–∏</button>
    </div>
  </div>

  <!-- –û—Å—Ç–∞–ª—å–Ω—ã–µ —ç–∫—Ä–∞–Ω—ã –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π -->
  <div id="start-screen" class="screen">
    <h1>REACTOR</h1>
    <p>–ö—Ç–æ –Ω–∞—á–Ω—ë—Ç –ø–µ—Ä–≤—ã–º?</p>
    <div class="dice" id="dice">?</div>
    <button onclick="startToss()">–ü–æ–¥–±—Ä–æ—Å–∏—Ç—å –∫—É–±–∏–∫</button>
  </div>

  <div id="game-screen" class="screen">
    <h1>REACTOR</h1>
    <div id="score">
      <div class="score-box you">–¢—ã: <span id="you-score">0</span></div>
      <div class="score-box bot">–ë–æ—Ç: <span id="bot-score">0</span></div>
    </div>
    <div id="status">–û–∂–∏–¥–∞–Ω–∏–µ –Ω–∞—á–∞–ª–∞...</div>
    <div id="board"></div>
    <div id="controls">
      <button onclick="resetToStart()">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
    </div>
    <div id="footer">
      –ö–∞–∂–¥—ã–π —Ä–µ–∞–∫—Ç–æ—Ä (‚óè) –ø–µ—Ä–µ–∫—Ä–∞—à–∏–≤–∞–µ—Ç —Å–æ—Å–µ–¥–Ω–∏–µ –∫–ª–µ—Ç–∫–∏.<br>
      –ü–æ—Å–ª–µ 14 —Ö–æ–¥–æ–≤ –ø–æ–±–µ–∂–¥–∞–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É—é—â–∏–π –±–æ–ª—å—à–µ.
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ (profile, changelog, info –∏ —Ç.–¥.) ‚Äî –∫–∞–∫ –≤ v0.3.1 -->
  <div id="profile-modal" class="modal-overlay">
    <div class="modal">
      <button class="close-modal" onclick="closeModal('profile-modal')">
        <svg viewBox="0 0 24 24">
          <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
        </svg>
      </button>
      <h2>Profile</h2>
      <div id="profile-stats"></div>
      <button id="profile-logout-btn" onclick="logout()" style="margin-top:16px;background:#555">–í—ã–π—Ç–∏</button>
    </div>
  </div>

  <div id="settings-modal" class="modal-overlay">
    <div class="modal">
      <button class="close-modal" onclick="closeModal('settings-modal')">
        <svg viewBox="0 0 24 24">
          <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
        </svg>
      </button>
      <h2>Settings</h2>
      <p>Soon</p>
    </div>
  </div>

  <div id="changelog-modal" class="modal-overlay">
    <div class="modal">
      <button class="close-modal" onclick="closeModal('changelog-modal')">
        <svg viewBox="0 0 24 24">
          <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
        </svg>
      </button>
      <h2>Changelog</h2>

      <div class="patch-entry">
        <div class="patch-header" onclick="togglePatch('patch-032')">
          v0.3.2
          <svg class="patch-arrow" id="arrow-032" viewBox="0 0 24 24">
            <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/>
          </svg>
        </div>
        <div class="patch-content" id="patch-032">
          <ul>
            <li>‚Ä¢ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∞–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è –∫–Ω–æ–ø–æ–∫</li>
            <li>‚Ä¢ –ò–∫–æ–Ω–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏ –≤—Ö–æ–¥–µ —á–µ—Ä–µ–∑ Google</li>
            <li>‚Ä¢ –û–±–Ω–æ–≤–ª—ë–Ω –¥–∏–∑–∞–π–Ω –∫–Ω–æ–ø–æ–∫ (Google + –≥–æ—Å—Ç—å)</li>
          </ul>
        </div>
      </div>

      <div class="patch-entry">
        <div class="patch-header" onclick="togglePatch('patch-031')">
          v0.3.1
          <svg class="patch-arrow" id="arrow-031" viewBox="0 0 24 24">
            <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/>
          </svg>
        </div>
        <div class="patch-content" id="patch-031">
          <ul>
            <li>‚Ä¢ –î–æ–±–∞–≤–ª–µ–Ω –≤—Ö–æ–¥ —á–µ—Ä–µ–∑ Google</li>
            <li>‚Ä¢ VK –≤—Ä–µ–º–µ–Ω–Ω–æ —É–±—Ä–∞–Ω</li>
          </ul>
        </div>
      </div>

      <div class="patch-entry">
        <div class="patch-header" onclick="togglePatch('patch-030')">
          v0.3.0
          <svg class="patch-arrow" id="arrow-030" viewBox="0 0 24 24">
            <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/>
          </svg>
        </div>
        <div class="patch-content" id="patch-030">
          <ul>
            <li>‚Ä¢ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ –≤—ã—Ö–æ–¥–∞ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞</li>
            <li>‚Ä¢ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã Changelog –∏ Info</li>
            <li>‚Ä¢ –í—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è ‚Äî —á–µ—Ä–µ–∑ –∫–∞—Å—Ç–æ–º–Ω—ã–µ –º–æ–¥–∞–ª–∫–∏</li>
          </ul>
        </div>
      </div>

      <div class="patch-entry">
        <div class="patch-header" onclick="togglePatch('patch-021')">
          v0.2.1
          <svg class="patch-arrow" id="arrow-021" viewBox="0 0 24 24">
            <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/>
          </svg>
        </div>
        <div class="patch-content" id="patch-021">
          <ul>
            <li>‚Ä¢ –ü–æ–ª–µ 7√ó7, 14 —Ö–æ–¥–æ–≤</li>
            <li>‚Ä¢ –¶–µ–ø–Ω–∞—è —Ä–µ–∞–∫—Ü–∏—è, –∑–≤—É–∫–∏</li>
          </ul>
        </div>
      </div>

      <div class="patch-entry">
        <div class="patch-header" onclick="togglePatch('patch-02')">
          v0.2
          <svg class="patch-arrow" id="arrow-02" viewBox="0 0 24 24">
            <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/>
          </svg>
        </div>
        <div class="patch-content" id="patch-02">
          <ul>
            <li>‚Ä¢ –£–ª—É—á—à–µ–Ω–Ω—ã–π –ò–ò-–±–æ—Ç</li>
            <li>‚Ä¢ –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞, –ø—Ä–æ—Ñ–∏–ª—å, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</li>
          </ul>
        </div>
      </div>

      <div class="patch-entry">
        <div class="patch-header" onclick="togglePatch('patch-01')">
          v0.1
          <svg class="patch-arrow" id="arrow-01" viewBox="0 0 24 24">
            <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/>
          </svg>
        </div>
        <div class="patch-content" id="patch-01">
          <ul>
            <li>‚Ä¢ –ë–∞–∑–æ–≤–∞—è –∏–≥—Ä–∞: 5√ó5, 10 —Ö–æ–¥–æ–≤</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <div id="support-modal" class="modal-overlay">
    <div class="modal">
      <button class="close-modal" onclick="closeModal('support-modal')">
        <svg viewBox="0 0 24 24">
          <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
        </svg>
      </button>
      <h2>–û–Ω–ª–∞–π–Ω-–ø–æ–¥–¥–µ—Ä–∂–∫–∞</h2>
      <p>Soon</p>
    </div>
  </div>

  <div id="info-modal" class="modal-overlay">
    <div class="modal">
      <button class="close-modal" onclick="closeModal('info-modal')">
        <svg viewBox="0 0 24 24">
          <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
        </svg>
      </button>
      <h2>Info</h2>

      <div class="info-section">
        <div class="info-header" onclick="toggleInfo('rules')">
          –ü—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã
          <svg class="info-arrow" id="arrow-rules" viewBox="0 0 24 24">
            <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/>
          </svg>
        </div>
        <div class="info-content" id="rules">
          <p>‚Ä¢ –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ: <strong>7√ó7 –∫–ª–µ—Ç–æ–∫</strong>.</p>
          <p>‚Ä¢ –í—Å–µ–≥–æ <strong>14 —Ö–æ–¥–æ–≤</strong> (–ø–æ 7 –Ω–∞ –∏–≥—Ä–æ–∫–∞).</p>
          <p>‚Ä¢ –ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ —Ä–µ–∞–∫—Ç–æ—Ä–∞ (‚óè) –≤—ã –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç–µ:</p>
          <p style="padding-left: 20px;">‚Äî –∫–ª–µ—Ç–∫—É —Å —Ä–µ–∞–∫—Ç–æ—Ä–æ–º,</p>
          <p style="padding-left: 20px;">‚Äî –≤—Å–µ 4 —Å–æ—Å–µ–¥–Ω–∏–µ –∫–ª–µ—Ç–∫–∏.</p>
          <p>‚Ä¢ –ü–æ–±–µ–∂–¥–∞–µ—Ç –∏–≥—Ä–æ–∫, –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É—é—â–∏–π –±–æ–ª—å—à–µ –∫–ª–µ—Ç–æ–∫ –ø–æ—Å–ª–µ 14 —Ö–æ–¥–æ–≤.</p>
        </div>
      </div>

      <div class="info-section">
        <div class="info-header" onclick="toggleInfo('agreement')">
          –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ
          <svg class="info-arrow" id="arrow-agreement" viewBox="0 0 24 24">
            <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/>
          </svg>
        </div>
        <div class="info-content" id="agreement">
          <p>‚Ä¢ –î–∞–Ω–Ω–∞—è –¥–µ–º–æ-–≤–µ—Ä—Å–∏—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è ¬´–∫–∞–∫ –µ—Å—Ç—å¬ª.</p>
          <p>‚Ä¢ –ê–≤—Ç–æ—Ä –Ω–µ –Ω–µ—Å—ë—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ —É—â–µ—Ä–±.</p>
          <p>‚Ä¢ –ò–≥—Ä–∞ –Ω–µ —Å–æ–±–∏—Ä–∞–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.</p>
          <p>‚Ä¢ –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã. –ó–∞–ø—Ä–µ—â–µ–Ω–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ.</p>
        </div>
      </div>

      <div class="info-section">
        <div class="info-header" onclick="toggleInfo('about')">
          –û –ø—Ä–æ–µ–∫—Ç–µ
          <svg class="info-arrow" id="arrow-about" viewBox="0 0 24 24">
            <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/>
          </svg>
        </div>
        <div class="info-content" id="about">
          <p>–ò–≥—Ä–∞ <strong>REACTOR</strong> —Å–æ–∑–¥–∞–Ω–∞ –∏ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç <strong>G3laZi Project</strong>.</p>
          <p>–í–µ—Ä—Å–∏—è: v0.3.2 (–¥–µ–º–æ)</p>
          <p>¬© 2025 G3laZi Project. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- üì¢ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
  <div id="notification-modal" class="modal-overlay">
    <div class="modal notification-modal">
      <button class="close-modal" onclick="closeNotification()">
        <svg viewBox="0 0 24 24">
          <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
        </svg>
      </button>
      <h2 id="notification-title">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ</h2>
      <p id="notification-text">–°–æ–æ–±—â–µ–Ω–∏–µ</p>
    </div>
  </div>

  <script>
    const SIZE = 7;
    const TOTAL_MOVES = 14;
    let board, reactors, moveCount, gameActive, currentPlayer, currentUser = null;

    // üîä –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–≤—É–∫–∞
    let audioInitialized = false;
    function initAudio() {
      if (audioInitialized) return;
      audioInitialized = true;
      const ctx = new (window.AudioContext || window.webkitAudioContext)();
      const oscillator = ctx.createOscillator();
      const gain = ctx.createGain();
      oscillator.connect(gain);
      gain.connect(ctx.destination);
      gain.gain.setValueAtTime(0.001, ctx.currentTime);
      oscillator.start();
      oscillator.stop(ctx.currentTime + 0.1);
    }
    document.body.addEventListener('click', initAudio, { once: true });
    document.body.addEventListener('touchstart', initAudio, { once: true });

    // üîä –ó–≤—É–∫–∏
    function playSound(id) {
      if (!audioInitialized) return;
      const sound = document.getElementById(`sound-${id}`);
      if (sound) {
        sound.currentTime = 0;
        sound.play().catch(e => console.log("Audio play prevented:", e));
      }
    }

    // üì¢ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    function showNotification(title, text) {
      document.getElementById('notification-title').textContent = title;
      document.getElementById('notification-text').textContent = text;
      document.getElementById('notification-modal').classList.add('active');
    }
    function closeNotification() {
      document.getElementById('notification-modal').classList.remove('active');
    }

    // üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    function saveUser(user) {
      localStorage.setItem('reactor_user', JSON.stringify(user));
      currentUser = user;
      updateUI();
    }
    function loadUser() {
      const saved = localStorage.getItem('reactor_user');
      currentUser = saved ? JSON.parse(saved) : null;
      updateUI();
    }
    function updateUI() {
      const authContainer = document.querySelector('.auth-container');
      const userInfo = document.getElementById('user-info');
      const userName = document.getElementById('user-name');
      const avatar = document.getElementById('user-avatar');

      if (currentUser) {
        authContainer.style.display = 'none';
        userInfo.style.display = 'block';
        userName.textContent = currentUser.name || '–ò–≥—Ä–æ–∫';
        avatar.textContent = (currentUser.name || '?')[0].toUpperCase();
        avatar.style.background = currentUser.photo 
          ? `url(${currentUser.photo}) center/cover no-repeat` 
          : '#4deeea';
      } else {
        authContainer.style.display = 'flex';
        userInfo.style.display = 'none';
      }
      renderStats();
    }

    // üö™ –í—ã—Ö–æ–¥
    function logout() {
      localStorage.removeItem('reactor_user');
      currentUser = null;
      updateUI();
      document.querySelectorAll('.modal-overlay').forEach(m => m.classList.remove('active'));
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById('main-menu').classList.add('active');
    }

    // üü¢ Google (—Å —Ç–≤–æ–∏–º ID + –∏–∫–æ–Ω–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–∏)
    function loginWithGoogle() {
      const btn = document.getElementById('google-btn');
      btn.classList.add('loading');
      
      const client = google.accounts.oauth2.initTokenClient({
        client_id: '712124061862-fun5umqbl2u9d4fsnve4pi4h2g4b21ug.apps.googleusercontent.com',
        scope: 'https://www.googleapis.com/auth/userinfo.profile',
        callback: (tokenResponse) => {
          btn.classList.remove('loading');
          if (tokenResponse.access_token) {
            fetch('https://www.googleapis.com/oauth2/v3/userinfo', {
              headers: { Authorization: `Bearer ${tokenResponse.access_token}` }
            })
            .then(res => res.json())
            .then(user => {
              saveUser({
                id: 'google_' + user.sub,
                name: user.name || user.given_name || 'Google User',
                photo: user.picture || null
              });
            })
            .catch(err => {
              console.error("Google login error:", err);
              showNotification("–û—à–∏–±–∫–∞", "–ù–µ —É–¥–∞–ª–æ—Å—å –≤–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google");
            });
          } else {
            showNotification("–û—à–∏–±–∫–∞", "–û—Ç–º–µ–Ω–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º");
          }
        }
      });
      client.requestAccessToken();
    }

    // üé© –ì–æ—Å—Ç—å
    function loginAsGuest() {
      const guestName = prompt("–ö–∞–∫ —Ç–µ–±—è –∑–æ–≤—É—Ç?", "–ò–≥—Ä–æ–∫");
      if (guestName) {
        saveUser({
          id: 'guest_' + Date.now(),
          name: guestName.trim() || '–ò–≥—Ä–æ–∫',
          isGuest: true
        });
      }
    }

    // üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    function getStatsKey() {
      return currentUser ? `reactor_stats_${currentUser.id}` : 'reactor_stats_guest';
    }
    function loadStats() {
      const key = getStatsKey();
      const saved = localStorage.getItem(key);
      return saved ? JSON.parse(saved) : { wins: 0, losses: 0, draws: 0 };
    }
    function saveStats(stats) {
      const key = getStatsKey();
      localStorage.setItem(key, JSON.stringify(stats));
    }
    function updateStats(result) {
      const stats = loadStats();
      if (result === 'win') stats.wins++;
      else if (result === 'loss') stats.losses++;
      else stats.draws++;
      saveStats(stats);
      renderStats();
    }
    function renderStats() {
      const stats = loadStats();
      const el = document.getElementById('profile-stats');
      if (el) {
        const total = stats.wins + stats.losses + stats.draws;
        const winrate = total ? Math.round((stats.wins / total) * 100) : 0;
        const name = currentUser ? currentUser.name : '–ì–æ—Å—Ç—å';
        el.innerHTML = `
          <div class="stats-box">
            <div class="stats-row">
              <span class="stats-label">üë§ –ò–≥—Ä–æ–∫:</span>
              <span class="stats-value">${name}</span>
            </div>
            <div class="stats-row">
              <span class="stats-label">üèÜ –ü–æ–±–µ–¥:</span>
              <span class="stats-value">${stats.wins}</span>
            </div>
            <div class="stats-row">
              <span class="stats-label">üíî –ü–æ—Ä–∞–∂–µ–Ω–∏–π:</span>
              <span class="stats-value">${stats.losses}</span>
            </div>
            <div class="stats-row">
              <span class="stats-label">üìà –í–∏–Ω—Ä–µ–π—Ç:</span>
              <span class="stats-value ${winrate >= 50 ? 'winrate-good' : 'winrate-bad'}">${winrate}%</span>
            </div>
          </div>
        `;
      }
    }

    // ‚öôÔ∏è –ò–≥—Ä–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
    function goToStartScreen() {
      if (!currentUser) {
        showNotification("–û—à–∏–±–∫–∞", "–°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Å—Ç—è");
        return;
      }
      document.getElementById('main-menu').classList.remove('active');
      document.getElementById('start-screen').classList.add('active');
    }

    function startToss() {
      playSound('toss');
      const dice = document.getElementById('dice');
      dice.textContent = '?';
      dice.className = 'dice animate';

      setTimeout(() => {
        const firstPlayer = Math.random() > 0.5 ? 'human' : 'bot';
        dice.textContent = firstPlayer === 'human' ? 'üë§' : 'ü§ñ';
        dice.style.color = firstPlayer === 'human' ? '#4deeea' : '#ff6b6b';
        dice.classList.remove('animate');

        setTimeout(() => {
          document.getElementById('start-screen').classList.remove('active');
          document.getElementById('game-screen').classList.add('active');
          initGame(firstPlayer);
        }, 600);
      }, 2200);
    }

    function initGame(firstPlayer) {
      board = Array(SIZE).fill().map(() => Array(SIZE).fill(0));
      reactors = Array(SIZE).fill().map(() => Array(SIZE).fill(false));
      moveCount = 0;
      gameActive = true;
      currentPlayer = firstPlayer;

      const statusEl = document.getElementById('status');
      if (currentPlayer === 'human') {
        statusEl.textContent = '–¢–≤–æ–π —Ö–æ–¥ ‚Äî –ø–æ—Å—Ç–∞–≤—å —Ä–µ–∞–∫—Ç–æ—Ä';
      } else {
        statusEl.textContent = '–ë–æ—Ç —Ö–æ–¥–∏—Ç –ø–µ—Ä–≤—ã–º...';
        render();
        setTimeout(botMove, 800);
      }
      render();
    }

    function render() {
      const boardEl = document.getElementById('board');
      boardEl.innerHTML = '';
      let youScore = 0, botScore = 0;

      for (let r = 0; r < SIZE; r++) {
        for (let c = 0; c < SIZE; c++) {
          const cell = document.createElement('div');
          cell.className = 'cell';
          if (board[r][c] === 1) {
            cell.classList.add('player1');
            youScore++;
          } else if (board[r][c] === 2) {
            cell.classList.add('player2');
            botScore++;
          }
          if (reactors[r][c]) cell.classList.add('reactor');

          if (gameActive && board[r][c] === 0 && moveCount < TOTAL_MOVES && currentPlayer === 'human') {
            cell.onclick = () => playerMove(r, c);
          }
          boardEl.appendChild(cell);
        }
      }

      document.getElementById('you-score').textContent = youScore;
      document.getElementById('bot-score').textContent = botScore;

      if (moveCount >= TOTAL_MOVES && gameActive) {
        gameActive = false;
        const statusEl = document.getElementById('status');
        let resultType = 'draw';
        if (youScore > botScore) {
          statusEl.textContent = 'üèÜ –ü–æ–±–µ–¥–∞!';
          resultType = 'win';
        } else if (botScore > youScore) {
          statusEl.textContent = 'üíî –ü–æ—Ä–∞–∂–µ–Ω–∏–µ.';
          resultType = 'loss';
        } else {
          statusEl.textContent = 'ü§ù –ù–∏—á—å—è!';
        }
        playSound('result');
        updateStats(resultType);
      }
    }

    // ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è activateReactor
    function activateReactor(row, col, player) {
      reactors[row][col] = true;
      board[row][col] = player;
      const dirs = [[-1,0], [1,0], [0,-1], [0,1]];
      
      let chainReaction = false;
      for (const [dr, dc] of dirs) {
        const nr = row + dr, nc = col + dc;
        if (nr >= 0 && nr < SIZE && nc >= 0 && nc < SIZE) {
          if (reactors[nr][nc]) chainReaction = true;
        }
      }

      for (const [dr, dc] of dirs) {
        const nr = row + dr, nc = col + dc;
        if (nr >= 0 && nr < SIZE && nc >= 0 && nc < SIZE) {
          board[nr][nc] = player;
          const cellIndex = nr * SIZE + nc;
          const cell = document.querySelector(`#board > .cell:nth-child(${cellIndex + 1})`);
          if (cell && chainReaction) {
            cell.classList.remove('chain');
            void cell.offsetWidth;
            cell.classList.add('chain');
          }
        }
      }

      playSound('click');
    }

    function playerMove(r, c) {
      if (!gameActive || currentPlayer !== 'human' || board[r][c] !== 0) return;
      activateReactor(r, c, 1);
      moveCount++;
      currentPlayer = 'bot';
      if (moveCount < TOTAL_MOVES) {
        document.getElementById('status').textContent = '–•–æ–¥ –±–æ—Ç–∞...';
        render();
        setTimeout(botMove, 600);
      } else {
        render();
      }
    }

    function botMove() {
      if (!gameActive || currentPlayer !== 'bot') return;

      const phase = moveCount < 5 ? 'early' : moveCount < 10 ? 'mid' : 'late';
      let moves = [];
      const dirs = [[-1,0],[1,0],[0,-1],[0,1]];

      for (let r = 0; r < SIZE; r++) {
        for (let c = 0; c < SIZE; c++) {
          if (board[r][c] !== 0) continue;

          let baseValue = 0;
          for (const [dr, dc] of dirs) {
            const nr = r + dr, nc = c + dc;
            if (nr >= 0 && nr < SIZE && nc >= 0 && nc < SIZE) {
              if (board[nr][nc] === 1) baseValue += 10;
              else if (board[nr][nc] === 0) baseValue += 4;
              else if (board[nr][nc] === 2) baseValue += 1;
            }
          }
          if (phase === 'early' && r >= 2 && r <= 4 && c >= 2 && c <= 4) {
            baseValue += 4;
          }

          let threatValue = 0;
          for (const [dr, dc] of dirs) {
            const nr = r + dr, nc = c + dc;
            if (nr >= 0 && nr < SIZE && nc >= 0 && nc < SIZE && board[nr][nc] === 1) {
              let futureDamage = 0;
              for (const [dr2, dc2] of dirs) {
                const nnr = nr + dr2, nnc = nc + dc2;
                if (nnr >= 0 && nnr < SIZE && nnc >= 0 && nnc < SIZE) {
                  if (board[nnr][nnc] === 2) futureDamage++;
                }
              }
              threatValue = Math.max(threatValue, futureDamage * 5);
            }
          }

          let opponentResponseValue = 0;
          const simBoard = board.map(row => [...row]);
          simBoard[r][c] = 2;
          for (const [dr, dc] of dirs) {
            const nr = r + dr, nc = c + dc;
            if (nr >= 0 && nr < SIZE && nc >= 0 && nc < SIZE) {
              simBoard[nr][nc] = 2;
            }
          }
          let bestOpponentValue = 0;
          for (let or = 0; or < SIZE; or++) {
            for (let oc = 0; oc < SIZE; oc++) {
              if (simBoard[or][oc] === 0) {
                let val = 0;
                for (const [dr, dc] of dirs) {
                  const nnr = or + dr, nnc = oc + dc;
                  if (nnr >= 0 && nnr < SIZE && nnc >= 0 && nnc < SIZE) {
                    if (simBoard[nnr][nnc] === 2) val += 10;
                    else if (simBoard[nnr][nnc] === 0) val += 4;
                  }
                }
                bestOpponentValue = Math.max(bestOpponentValue, val);
              }
            }
          }
          opponentResponseValue = -bestOpponentValue * 0.7;

          let totalValue = baseValue + threatValue + opponentResponseValue;
          totalValue += (Math.random() - 0.5) * 2;

          moves.push({ r, c, value: totalValue });
        }
      }

      if (moves.length === 0) return;

      moves.sort((a, b) => b.value - a.value);
      const topMoves = moves.slice(0, 2);
      const chosen = topMoves[Math.floor(Math.random() * topMoves.length)];

      activateReactor(chosen.r, chosen.c, 2);
      moveCount++;
      currentPlayer = 'human';
      if (moveCount < TOTAL_MOVES) {
        document.getElementById('status').textContent = '–¢–≤–æ–π —Ö–æ–¥ ‚Äî –ø–æ—Å—Ç–∞–≤—å —Ä–µ–∞–∫—Ç–æ—Ä';
      }
      render();
    }

    function resetToStart() {
      document.getElementById('game-screen').classList.remove('active');
      document.getElementById('start-screen').classList.add('active');
    }

    function closeModal(modalId) {
      document.getElementById(modalId).classList.remove('active');
      if (modalId === 'profile-modal') {
        renderStats();
      }
    }

    function togglePatch(patchId) {
      const content = document.getElementById(patchId);
      const arrow = document.getElementById(`arrow-${patchId}`);
      content.classList.toggle('open');
      arrow.style.transform = content.classList.contains('open') ? 'rotate(180deg)' : 'rotate(0deg)';
    }

    function toggleInfo(sectionId) {
      const content = document.getElementById(sectionId);
      const arrow = document.getElementById(`arrow-${sectionId}`);
      content.classList.toggle('open');
      arrow.style.transform = content.classList.contains('open') ? 'rotate(180deg)' : 'rotate(0deg)';
    }

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫
    document.getElementById('google-btn').onclick = loginWithGoogle;
    document.getElementById('profile-btn').onclick = () => {
      if (!currentUser) {
        showNotification("–û—à–∏–±–∫–∞", "–°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Å—Ç—è");
        return;
      }
      document.getElementById('profile-modal').classList.add('active');
    };
    // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ (settings, changelog –∏ —Ç.–¥.) ‚Äî –∫–∞–∫ –≤ v0.3.1

    document.getElementById('settings-btn').onclick = () => {
      if (!currentUser) {
        showNotification("–û—à–∏–±–∫–∞", "–°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Å—Ç—è");
        return;
      }
      document.getElementById('settings-modal').classList.add('active');
    };
    document.getElementById('changelog-btn').onclick = () => {
      document.getElementById('changelog-modal').classList.add('active');
    };
    document.getElementById('support-btn').onclick = () => {
      document.getElementById('support-modal').classList.add('active');
    };
    document.getElementById('info-btn').onclick = () => {
      document.getElementById('info-modal').classList.add('active');
    };

    document.querySelectorAll('.modal-overlay').forEach(overlay => {
      overlay.addEventListener('click', (e) => {
        if (e.target === overlay) {
          overlay.classList.remove('active');
        }
      });
    });

    // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
    loadUser();

    // –ü–æ–¥–≥—Ä—É–∑–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    renderStats();

    // üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞ –¥–ª—è Google OAuth (–≤ –∫–æ–Ω—Å–æ–ª–∏)
    console.log(
      "%c‚ö†Ô∏è Google OAuth: –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ 400 ‚Äî –¥–æ–±–∞–≤—å—Ç–µ –≤ Google Cloud Console:\n" +
      "http://localhost\nhttp://localhost:8000\nhttp://127.0.0.1\nhttps://–≤–∞—à-–¥–æ–º–µ–Ω.—Ä—É",
      "color: #ff6b6b; font-weight: bold;"
    );
  </script>
</body>
</html>
